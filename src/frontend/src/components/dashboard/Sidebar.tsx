"use client";

import { motion } from "framer-motion";
import Link from "next/link";
import { usePathname } from "next/navigation";
import { cn } from "@/lib/utils";

type NavItem = {
  id: string;
  label: string;
  icon: React.ReactNode;
  href: string;
};

const chatNavItem: NavItem = {
  id: "chat",
  label: "Chat with Agent",
  href: "/",
  icon: (
    <svg
      className="w-4 h-4"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        strokeLinecap="round"
        strokeLinejoin="round"
        strokeWidth={1.5}
        d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
      />
    </svg>
  ),
};

const tradingNavItems: NavItem[] = [
  {
    id: "media-buys",
    label: "Media Buys",
    href: "/dashboard/media-buys",
    icon: (
      <svg
        className="w-4 h-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          strokeLinecap="round"
          strokeLinejoin="round"
          strokeWidth={1.5}
          d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
        />
      </svg>
    ),
  },
  {
    id: "products",
    label: "Products",
    href: "/dashboard/products",
    icon: (
      <svg
        className="w-4 h-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          strokeLinecap="round"
          strokeLinejoin="round"
          strokeWidth={1.5}
          d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"
        />
      </svg>
    ),
  },
  {
    id: "formats",
    label: "Formats",
    href: "/dashboard/formats",
    icon: (
      <svg
        className="w-4 h-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          strokeLinecap="round"
          strokeLinejoin="round"
          strokeWidth={1.5}
          d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"
        />
      </svg>
    ),
  },
];

interface NavLinkProps {
  item: NavItem;
  isActive: boolean;
}

function NavLink({ item, isActive }: NavLinkProps) {
  return (
    <li>
      <Link href={item.href}>
        <motion.div
          whileHover={{ x: 2 }}
          whileTap={{ scale: 0.98 }}
          className={cn(
            "relative w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg",
            "transition-colors duration-150 cursor-pointer text-left",
            isActive
              ? "bg-muted text-foreground"
              : "text-muted-foreground hover:bg-muted/50 hover:text-foreground"
          )}
        >
          <span className="transition-colors duration-150">{item.icon}</span>
          <span>{item.label}</span>
        </motion.div>
      </Link>
    </li>
  );
}

export default function Sidebar() {
  const pathname = usePathname();

  // Determine active item based on current pathname
  const getIsActive = (href: string) => {
    if (href === "/") {
      return pathname === "/";
    }
    return pathname.startsWith(href);
  };

  return (
    <aside className="w-[260px] flex-shrink-0 bg-background border-r border-border h-full flex flex-col">
      {/* Branding */}
      <motion.div
        initial={{ opacity: 0, y: -10 }}
        animate={{ opacity: 1, y: 0 }}
        className="px-4 py-4 border-b border-border"
      >
        <div className="flex items-center gap-2">
          {/* Signal42 Logo */}
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1907 2116"
            className="w-6 h-6"
          >
            {/* Cyan accent elements */}
            <g fill="#41e9fd">
              <path d="m491.855743 1280.366943c-104.749542-389.634643-48.188018-766.371826 122.17508-987.735229-357.460266 124.692139-614.030943 464.550293-614.030943 864.52771 0 505.675293 409.930662 915.605957 915.606199 915.605957 50.295776 0 99.588257-4.220459 147.68042-12.021729-246.838684-116.005371-470.688171-405.648803-571.430756-780.376709z"/>
              <path d="m1134.718262 268.137207c4.415283-57.793945 12.98291-107.838135 25.662231-148.583984-93.571289-30.807618-189.027466-36.292969-281.162597-11.523438-105.591309 28.387329-194.988709 93.38855-265.187073 184.601929 94.462097-32.95105 195.877075-51.078369 301.575256-51.078369 75.546997 0 148.886353 9.332397 219.112183 26.583862z"/>
              <path d="m1548.866211 1818.101807c-130.816162 125.371215-298.64502 212.316772-485.579712 242.641845 115.577148 54.316895 236.173706 70.704834 351.568359 39.682373 93.787598-25.213623 174.78125-79.348266 240.938233-155.009521-34.583008-30.520874-70.608521-73.621826-106.92688-127.314697z"/>
            </g>
            {/* Purple brand elements */}
            <path d="m1238.262817 1074.497437c-84.647094-314.859375-118.814819-606.504395-103.544555-806.36023-70.22583-17.251465-143.565186-26.583862-219.112183-26.583862-105.698181 0-207.113159 18.127319-301.575256 51.078369-170.363098 221.363403-226.924622 598.100586-122.17508 987.735229 100.742585 374.727906 324.592072 664.371338 571.430756 780.376709 186.934692-30.325073 354.76355-117.27063 485.579712-242.641845-112.115479-165.748902-226.989746-432.589356-310.603394-743.60437z" fill="#4D3EFE"/>
            <path d="m1816.156372 984.258301c89.151489 387.269775 20.019043 754.861938-160.363281 961.158203 47.513428 41.932617 92.302002 60.215698 131.355835 49.716675 149.471069-40.183228 160.447754-486.613648 29.007446-1010.874878z" fill="#41e9fd"/>
            <path d="m1787.789795 877.777832c-148.94812-527.153809-385.371948-915.610352-536.27771-875.040283-40.705933 10.943359-71.039917 52.251221-91.131592 116.815674 262.592529 86.455566 510.250855 373.3302 627.409302 758.224609z" fill="#41e9fd"/>
            <path d="m1816.156372 984.258301c-2.759277-11.008301-5.626953-22.06836-8.512329-33.1427 15.244507 66.257324 23.567749 135.158813 23.567749 206.043823 0 259.879883-108.451416 494.286133-282.345581 660.942383 36.318359 53.692871 72.343872 96.793823 106.92688 127.314697 180.382324-206.296265 249.51477-573.888428 160.363281-961.158203z" fill="#4D3EFE"/>
            <path d="m1788.446899 880.151367c-.221679-.786743-.434326-1.587524-.657104-2.373535-117.158447-384.894409-364.816773-671.769043-627.409302-758.224609-12.679321 40.745849-21.246948 90.790039-25.662231 148.583984 310.059082 76.169556 558.006225 310.140747 653.728637 612.01416z" fill="#3994FB"/>
            <path d="m1788.446899 880.151367c-95.722412-301.873413-343.669555-535.844604-653.728637-612.01416-15.270264 199.855835 18.897461 491.500855 103.544555 806.36023 83.613648 311.015014 198.487915 577.855468 310.603394 743.60437 173.894165-166.65625 282.345581-401.0625 282.345581-660.942383 0-70.88501-8.323242-139.786499-23.567749-206.043823-2.409424-9.244996-4.749512-18.455689-7.24646-27.74231-3.904175-14.523682-7.913208-28.896606-11.950684-43.221924z" fill="#4D3EFE"/>
            {/* S42 text - white on colored logo background */}
            <path d="m1191.39624 907.203369v68.019409h-81.619262v-68.019409h-155.4693v-66.070801l128.744324-193.366211h108.344238v196.768677h50.52771v62.668335zm-78.706421-62.668335v-36.437988c0-36.276245 1.130982-70.281006 3.402466-102.024048h-.974243c-16.5177 29.794556-35.463501 60.729858-56.842773 92.785889l-31.091797 45.676147z" fill="#fff"/>
            <path d="m1450.338623 652.138062c18.46106 8.097412 32.71228 19.516357 42.753052 34.25708 10.035766 14.740722 15.064087 31.662353 15.064087 50.764648 0 18.466309-3.483643 34.337891-10.444702 47.614746-6.97168 13.286865-16.442383 24.61499-28.421509 34.004517-11.98938 9.399902-27.376343 18.950927-46.155762 28.663696-19.435669 10.046021-34.095337 18.466309-43.969726 25.271362-9.884156 6.7948-16.603638 12.872803-20.162476 18.213868-3.569092 5.351074-5.66919 11.257446-6.315186 17.739379h163.722779v66.55542h-261.375367c-.328125-2.917724-.484741-7.935913-.484741-15.06372 0-23.312622 2.746582-43.313599 8.259033-60.003052 5.50232-16.669068 15.05896-32.136841 28.663697-46.392822 13.604736-14.246094 32.707153-28.179078 57.32727-41.778931 18.461548-10.369019 32.551026-18.870239 42.268799-25.51355 9.717896-6.633423 17.40625-13.842163 23.07544-21.616455 5.664062-7.77417 8.505737-16.679199 8.505737-26.725098 0-10.358886-3.245606-18.536987-9.717896-24.534301-6.481323-5.987183-15.548095-8.98584-27.209472-8.98584-14.256226 0-25.104737 4.129394-32.551026 12.388428-7.450805 8.258789-11.171508 20.334106-11.171508 36.195434h-83.078003c.317993-36.266235 11.661377-64.203003 34.009399-83.799927 22.348511-19.597168 53.273926-29.400879 92.791138-29.400879 24.61499 0 46.155883 4.058716 64.616943 12.145997z" fill="#fff"/>
            <path d="m827.990601 892.31665c57.73645 47.715577 86.60205 117.269654 86.60205 208.672364h-216.502136c0-38.487549-11.030334-67.948609-33.075744-88.404053-22.060608-20.445313-53.520936-30.662842-94.416565-30.662842-34.48407 0-61.941254 7.420899-82.386506 22.242554-20.450347 14.851562-30.672973 34.287231-30.672973 58.336792 0 18.456299 5.411804 33.489746 16.240204 45.11084 10.823303 11.631103 27.85083 21.848633 51.112854 30.662597 23.252136 8.834229 57.736206 18.849854 103.442627 30.077393 68.140686 16.830566 123.282165 34.2771 165.379089 52.319336 42.096985 18.042236 76.560974 44.706909 103.437561 79.983642 26.856506 35.28711 40.294678 82.194825 40.294678 140.723511 0 55.328369-14.432801 103.639771-43.303467 144.933838-28.86554 41.304566-69.569153 73.178589-122.080444 95.612793-52.526612 22.444458-114.074219 33.681763-184.622742 33.681763-112.271881 0-200.075256-26.048828-263.409912-78.176392-63.349915-52.117554-95.017258-125.488281-95.017258-220.111572h221.312973c0 88.22229 47.301727 132.3031 141.925049 132.3031 39.275085 0 70.154846-8.006591 92.614258-24.04956 22.439331-16.032959 33.676636-38.073486 33.676636-66.151489 0-20.849121-5.411805-37.286133-16.240174-49.320923-10.823303-12.025025-26.66449-21.838623-47.508484-29.461426-20.859314-7.612671-54.121948-17.446411-99.828125-29.471436-69.761139-17.628173-125.503265-35.276733-167.186218-52.925292-41.703278-17.628174-76.187378-43.687012-103.43753-78.176392-27.270508-34.469116-40.8956-80.589233-40.8956-138.320679 0-52.107422 13.625092-97.813598 40.8956-137.108887 27.250152-39.285156 66.338348-69.766235 117.269622-91.412841 50.91095-21.646607 110.055542-32.480103 177.408631-32.480103 108.248657 0 191.240905 23.86792 248.972046 71.573364z" fill="#fff"/>
          </svg>
          <span className="text-foreground text-lg font-semibold tracking-tight">
            Signal42
          </span>
        </div>
      </motion.div>

      {/* Navigation */}
      <nav className="flex-1 px-3 py-4">
        {/* Chat link */}
        <motion.ul
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
          className="space-y-1 mb-4"
        >
          <NavLink item={chatNavItem} isActive={getIsActive(chatNavItem.href)} />
        </motion.ul>

        {/* Trading Section */}
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.15 }}
          className="text-muted-foreground text-xs uppercase tracking-wider mb-3 px-3 font-medium"
        >
          Trading
        </motion.div>
        <motion.ul
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2 }}
          className="space-y-1"
        >
          {tradingNavItems.map((item) => (
            <NavLink
              key={item.id}
              item={item}
              isActive={getIsActive(item.href)}
            />
          ))}
        </motion.ul>
      </nav>

      {/* Footer */}
      <motion.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        transition={{ delay: 0.3 }}
        className="px-4 py-3 border-t border-border"
      >
        <div className="text-muted-foreground text-xs">Signal42</div>
      </motion.div>
    </aside>
  );
}
